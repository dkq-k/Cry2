# RSA Low Exponent 복호화 예제
# 조건: m^e < n 이 반드시 성립해야 함
# 공격 방식: 세제곱근 바로 구해서 복호화함

import gmpy2

# 공개된 RSA 파라미터
n = 2648831733753954917153064354936167521019304887202194827600530818983909477430552
e = 3
c = 2648831733753954917153064354936167521019304887202194827600530818983909477430429

# gmpy2의 iroot 함수로 세제곱근 구하기
# 정확하게 m³ == c인 m 값을 찾아냄
m, exact = gmpy2.iroot(c, e)

if exact:
    # 정수 m을 바이트로 바꾸고, 디코딩
    plaintext = m.to_bytes((m.bit_length() + 7) // 8, 'big')
    print(f"복호화 성공! FLAG: NT{{{plaintext.decode()}}}")
else:
    print("[!] 세제곱근이 정확히 떨어지지 않음. m³ < n 조건을 다시 확인할 것.")